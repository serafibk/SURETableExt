<!DOCTYPE html>
<html>
<!--this is css part-->
<style>
	#table{
		position: absolute; top: 0px; left: 0px;
		z-index:-1;
	}
	button{
		position: relative;
	}
	.json{
		position: relative;
	}	

</style>
<body onload = "imgDim()" onkeypress="printCoords()" >
<div id="container"> 
	<img id="table" src="https://www.dummies.com/wp-content/uploads/503641.image0.jpg"></img>
</div>
<form action = "http://localhost:8080" method="POST">
	<textarea class = "json" name = "JSON" type="text" id ="json"></textarea>
	<button id ="but" type="submit">Get Coordinates</button>
</form>

<!--script to record drawn rectangles-->
<script>
document.addEventListener("mousedown",mouseDown);
document.addEventListener("mouseup",mouseUp);
document.addEventListener("mousemove",mouseMove);
var isDown=false; 
var row =0;
var col =0;
var startX,finalX,startY,finalY,rect;
var allCoords={
	table:[]
};
var rowCol={
	rc:[]
};
function mouseDown(e){
	rect = document.createElement("canvas");
	rect.width = document.getElementById("table").clientWidth;
	rect.height = document.getElementById("table").clientHeight;
	rect.style.cssText = "position:absolute;top:0px;left:0px;";
	document.getElementById("container").appendChild(rect);
	isDown=true;
	startX = e.clientX-rect.getBoundingClientRect().left;
	startY = e.clientY-rect.getBoundingClientRect().top;
	rect.style.cursor = "crosshair";
}

function mouseMove(e){
	if(isDown){
		var ctx = rect.getContext("2d");
		ctx.clearRect(0,0,rect.width,rect.height);
		finalX = e.clientX-rect.getBoundingClientRect().left;
		finalY = e.clientY-rect.getBoundingClientRect().top;
		ctx.lineWidth = 1;
		ctx.strokeStyle = "black";
		ctx.strokeRect(startX,startY,finalX-startX,finalY-startY);
		rect.style.cursor = "default";
	}

	
}
function mouseUp(e){
	isDown=false;
	var points = {minX:startX, minY:startY, maxX:finalX, maxY:finalY};
	allCoords.table.push(points);
}

function imgDim(){
	var width = document.getElementById("table").offsetWidth;
	var height = document.getElementById("table").offsetHeight;
	document.getElementById("but").style.left = "0px";
	document.getElementById("but").style.top = height+'px';
	document.getElementById("json").style.left = "0px";
	document.getElementById("json").style.top = height+'px';
}
function printCoords(){
	var k = event.key;
	if(k == 'z'){
		var ctx = rect.getContext("2d");
		ctx.clearRect(startX-5,startY-5,finalX-startX+10,finalY-startY+10);
		allCoords.table.pop();
	}
	else{
		var json = JSON.stringify(allCoords);
		document.getElementById("json").innerHTML = json;
		console.log(document.getElementById("json").innerHTML);
	}	
}

</script>

</body>
</html>